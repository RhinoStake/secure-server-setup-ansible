---
# Hostname
- name: Change hostname
  ansible.builtin.hostname:
    name: '{{ hostname }}'
    use: debian

# Modify Hosts
- name: Update hosts file
  ansible.builtin.template:
    src: etc_hosts.j2
    dest: '/etc/hosts'
    owner: 'root'
    group: 'root'
    mode: '0644'

# Update limits
- name: Update limits for user
  ansible.builtin.blockinfile:
    path: /etc/security/limits.conf
    insertbefore: "# End of file"
    marker: "# {mark} ANSIBLE MANAGED BLOCK"
    block: |
      {{ name }} soft nofile 1048576
      {{ name }} hard nofile 1048576
      {{ name }} soft nproc 1048576
      {{ name }} hard nproc 1048576