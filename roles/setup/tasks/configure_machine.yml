---
# Hostname
- name: Change hostname
  ansible.builtin.hostname:
    name: "{{ inventory_hostname }}"
    use: debian

# Modify Hosts
- name: Update hosts file
  ansible.builtin.template:
    src: etc_hosts.j2
    dest: "/etc/hosts"
    owner: "root"
    group: "root"
    mode: "0644"

# Update limits
- name: Update limits for user
  ansible.builtin.blockinfile:
    path: /etc/security/limits.conf
    insertbefore: "# End of file"
    marker: "# {mark} ANSIBLE MANAGED BLOCK"
    block: |
      {{ ansible_user }} soft nofile 1048576
      {{ ansible_user }} hard nofile 1048576
      {{ ansible_user }} soft nproc 1048576
      {{ ansible_user }} hard nproc 1048576
