---
- name: Force uniform sources.list
  ansible.builtin.template:
    src: sources.list.j2
    dest: "/etc/apt/sources.list"
    owner: "root"
    group: "root"
    mode: "0644"

- name: Apt update and upgrade
  ansible.builtin.apt:
    update_cache: true
    upgrade: full
    autoremove: true
    autoclean: true

# Ensure sudo is installed
- name: Install required packages
  ansible.builtin.apt:
    name:
      - sudo
      - zsh
      - git
    state: present
    update_cache: true
    cache_valid_time: 3600
